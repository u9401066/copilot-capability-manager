# /cp.cleanup å·¥ä½œæµç¨‹
# æ¸…ç†å’Œé‡æ§‹å°ˆæ¡ˆ

workflow:
  id: cleanup
  name: å°ˆæ¡ˆæ¸…ç†
  description: æ¸…ç†è‡¨æ™‚æª”æ¡ˆå’Œé‡æ§‹å°ˆæ¡ˆçµæ§‹
  command: /cp.cleanup
  
  # è§¸ç™¼è©
  triggers:
    - /cp.cleanup
    - æ¸…ç†å°ˆæ¡ˆ
    - cleanup
    - æ•´ç†å°ˆæ¡ˆ
    
  # åƒæ•¸
  parameters:
    scope:
      description: æ¸…ç†ç¯„åœ
      required: false
      default: standard
      options: [minimal, standard, deep]
    restructure:
      description: æ˜¯å¦é‡æ§‹æª”æ¡ˆçµæ§‹
      required: false
      default: false
      
  # åŸ·è¡Œæ­¥é©Ÿ
  steps:
    - step: 1
      skill: temp-cleaner
      name: æ¸…ç†æš«å­˜
      description: æ¸…ç†è‡¨æ™‚æª”æ¡ˆå’Œå¿«å–
      input:
        scope: "{{scope}}"
      output: clean_results
      
    - step: 2
      skill: file-restructurer
      name: æª”æ¡ˆé‡æ§‹
      description: é‡çµ„æª”æ¡ˆçµæ§‹
      condition: "{{restructure}}"
      input:
        dry_run: true
      output: restructure_plan
      confirm: true
      
    - step: 3
      skill: file-restructurer
      name: åŸ·è¡Œé‡æ§‹
      description: åŸ·è¡Œæª”æ¡ˆé‡æ§‹
      condition: "{{restructure}} && {{user_confirmed}}"
      input:
        plan: "{{restructure_plan}}"
      output: restructure_results
      
    - step: 4
      skill: memory-updater
      name: æ›´æ–°è¨˜æ†¶
      description: è¨˜éŒ„æ¸…ç†çµæœ
      input:
        action: "å°ˆæ¡ˆæ¸…ç†"
        details: "{{clean_results}}"
        
  # è¼¸å‡º
  output:
    type: summary
    format: |
      ğŸ§¹ æ¸…ç†å®Œæˆ
      
      {{clean_results.summary}}
      
      {{#if restructure_results}}
      ğŸ”§ é‡æ§‹çµæœï¼š
      {{restructure_results.summary}}
      {{/if}}
      
  # å¾ŒçºŒå»ºè­°
  followup:
    - "åŸ·è¡Œæ¸¬è©¦ç¢ºèªåŠŸèƒ½æ­£å¸¸"
    - "æäº¤è®Šæ›´åˆ° Git"
