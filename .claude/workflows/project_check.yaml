# /cp.project_check å·¥ä½œæµç¨‹
# å°ˆæ¡ˆç‹€æ…‹æª¢æŸ¥çš„å®Œæ•´æµç¨‹

workflow:
  id: project_check
  name: å°ˆæ¡ˆæª¢æŸ¥
  description: æª¢æŸ¥å°ˆæ¡ˆç‹€æ…‹ä¸¦æ›´æ–°å¿…è¦æ–‡ä»¶
  command: /cp.project_check
  
  # è§¸ç™¼è©
  triggers:
    - /cp.project_check
    - æª¢æŸ¥å°ˆæ¡ˆ
    - å°ˆæ¡ˆç‹€æ…‹
    - project check
    
  # åƒæ•¸
  parameters:
    scope:
      description: æª¢æŸ¥ç¯„åœ
      required: false
      default: full
      options: [full, quick, docs-only]
    auto_fix:
      description: è‡ªå‹•ä¿®å¾©å•é¡Œ
      required: false
      default: false
      
  # åŸ·è¡Œæ­¥é©Ÿ
  steps:
    - step: 1
      skill: project-checker
      name: å°ˆæ¡ˆæª¢æŸ¥
      description: åŸ·è¡Œå…¨é¢æª¢æŸ¥
      input:
        scope: "{{scope}}"
      output: check_results
      
    - step: 2
      skill: doc-updater
      name: æ–‡ä»¶æ›´æ–°
      description: æ›´æ–°éœ€è¦ä¿®æ­£çš„æ–‡ä»¶
      condition: "{{check_results.docs_need_update}}"
      input:
        issues: "{{check_results.doc_issues}}"
        auto_fix: "{{auto_fix}}"
      output: doc_updates
      
    - step: 3
      skill: memory-updater
      name: Memory Bank åŒæ­¥
      description: åŒæ­¥ Memory Bank
      input:
        check_results: "{{check_results}}"
        updates: "{{doc_updates}}"
      output: memory_status
      
    - step: 4
      skill: project-checker
      name: æœ€çµ‚é©—è­‰
      description: é©—è­‰æ‰€æœ‰å•é¡Œå·²è§£æ±º
      condition: "{{auto_fix}}"
      input:
        scope: quick
      output: final_status
      
  # è¼¸å‡º
  output:
    type: report
    format: |
      ğŸ” å°ˆæ¡ˆæª¢æŸ¥å ±å‘Š
      
      {{check_results.summary}}
      
      {{#if doc_updates}}
      ğŸ“ å·²æ›´æ–°çš„æ–‡ä»¶ï¼š
      {{doc_updates.files}}
      {{/if}}
      
      ğŸ“Š æ•´é«”ç‹€æ…‹ï¼š{{final_status.grade}}
      
  # å¾ŒçºŒå»ºè­°
  followup:
    - "æ˜¯å¦è¦åŸ·è¡Œæ¸¬è©¦ï¼Ÿ"
    - "æ˜¯å¦è¦æº–å‚™ commitï¼Ÿ"
    - "æ˜¯å¦è¦æŸ¥çœ‹è©³ç´°å ±å‘Šï¼Ÿ"
